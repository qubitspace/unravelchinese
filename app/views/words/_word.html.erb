
<% status = (@word_statuses.has_key?(word.id) ? @word_statuses[word.id].status : 'unknown') %>
<% status = 'known' if word.category == 'punctuation' %>
<% show_pinyin = ['unknown'].include? status %>
<% show_mark_unknown = ['known'].include? status %>
<% show_mark_known = ['unknown'].include? status %>
<div class='word_wrapper <%= word.category %> <%= status %>' wordid="<%= word.id %>">

  <div class="tooltip_wrapper">
    <% if status == 'known' || word.category == 'punctuation' %>
      <span class='top learnable'>
        <%= word.simplified %><br/>
      </span>

      <span class='bottom learnable'>
        <%= word.pinyin %>
      </span>
    <% elsif status == 'learning' %>
      <span class='top learnable'>
        <%= word.simplified %><br/>
      </span>

      <span class='bottom learnable'>
        <%= word.pinyin %>
      </span>
    <% else %>
      <span class='top learnable'>
        <%= word.pinyin %><br/>
      </span>

      <span class='bottom learnable'>
        <%= word.simplified %>
      </span>
    <% end %>
  </div>

  <!--% unless word.punctuation? %-->
    <div class="tooltip <%= word.category %> <%= status %>" wordId="<%= word.id %>">
      <div class="close_tooltip close_button">&#10006;</div>

      <span class='top'>
        <%= link_to word.simplified, word_path(word) %>
      </span><br>

      <span class='bottom'>
        <%= word.pinyin %>
      </span>

      <hr>

      <div class="definitions">
        <strong>
        <% word.definitions.each do |definition| %>
          â€¢ <%= raw definition.html_value %><br/>
        <% end %>
        </strong>
      </div>

      <% if word.definitions.any? %><hr><% end %>

      <% if status == 'known' %>
        <%= link_to "Mark as Unknown", update_learned_word_status_path(article_id: @article.id, word_id: word.id, status: :unknown), remote: true %><br/>
        <%= link_to "Mark as Learning", update_learned_word_status_path(article_id: @article.id, word_id: word.id, status: :learning), remote: true %>
      <% elsif status == 'learning' %>
        <%= link_to "Mark as Known", update_learned_word_status_path(article_id: @article.id, word_id: word.id, status: :known), remote: true %><br/>
        <%= link_to "Mark as Unknown", update_learned_word_status_path(article_id: @article.id, word_id: word.id, status: :unknown), remote: true %>
      <% else %>
        <%= link_to "Mark as Known", update_learned_word_status_path(article_id: @article.id, word_id: word.id, status: :known), remote: true %><br/>
        <%= link_to "Mark as Learning", update_learned_word_status_path(article_id: @article.id, word_id: word.id, status: :learning), remote: true %>
      <% end %>

    </div>
  <!--% end %-->
</div>